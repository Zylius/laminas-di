<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Automated dependency injection for PSR-11 containers"> 

    
    
        
    
    <meta name="docsearch:version" content="3.0.0,latest">
    <meta name="docsearch:language" content="en">
    <meta name="docsearch:component" content="laminas-di">

    <link rel="canonical" href="https://docs.laminas.dev/laminas-di/v2/definitions/">
    <link rel="shortcut icon" href="https://docs.laminas.dev/img/trademark-laminas-foundation-rgb.svg">

    <title>Dependency Definitions - laminas-di - Laminas Docs</title>

    <link rel="stylesheet" href="https://docs.laminas.dev/css/styles.css">
    
</head>
<body id="page-top" class="components" data-spy="scroll" data-target=".toc" data-offset="20">

    
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        
        <a class="logo-link navbar-brand" href="https://getlaminas.org/" data-tooltip data-placement="bottom" title="Go to the Laminas homepage">
            <img src="https://docs.laminas.dev/img/laminas-foundation-white.svg" height="28" alt="Laminas">
        </a>
        <a class="navbar-title" href="https://docs.laminas.dev/" data-tooltip data-placement="bottom" title="Go to the Laminas Documentation">
            Documentation
        </a>

        
        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="dropdown sub-project-selector">
                        <a class="dropdown-toggle nav-link" data-toggle="dropdown" aria-expanded="false">
                            All Docs
                        </a>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a href="https://docs.mezzio.dev/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mezzio-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Mezzio</strong><br>
                                        PSR-15 Middleware in Minutes
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/components/" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-components-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>Components</strong><br>
                                        Components for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://docs.laminas.dev/mvc" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-mvc-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>MVC</strong><br>
                                        MVC for Enterprise Applications
                                    </div>
                                </div>
                            </a>
                            <a href="https://api-tools.getlaminas.org/documentation" class="dropdown-item">
                                <div class="row align-items-center">
                                    <div class="col-md-4 col-sm-12">
                                        <img src="https://docs.laminas.dev/img/laminas-api-tools-rgb.svg">
                                    </div>
                                    <div class="col-md-8 col-sm-12">
                                        <strong>API Tools</strong><br>
                                        Build RESTful APIs in Minutes
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/migration/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Migration to Laminas
                                    </div>
                                </div>
                            </a>
                            <a class="dropdown-item dropdown-item--secondardy" href="https://docs.laminas.dev/tutorials/">
                                <div class="row align-items-center">
                                    <div class="col-md-8 offset-md-4 col-sm-12">
                                        Tutorials
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="nav-item">
                    <a href="https://getlaminas.org/participate" class="nav-link">Community</a>
                </li>
            </ul>

            
            
                <div class="d-block d-sm-none">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">laminas-di</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                
            

                
                
                    
                        
    <li class="subnavigation__list-item ">
        <a href="../quick-start/" class="subnavigation__link">Quick Start</a>
    </li>

                    
                        
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">Reference</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Dependency Definitions</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../instance-manager/" class="subnavigation__link">Instance Manager</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../config/" class="subnavigation__link">Configuration</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../debugging-and-complex-use-cases/" class="subnavigation__link">Debugging And Complex Use Cases</a>
    </li>

            
        </ul>
    </li>

                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="d-block d-sm-none">
                <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentationâ€¦</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</nav>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-8">
                <h1 class="header__title">
                    Components

                    
                        <small class="header__subtitle">laminas-di</small>
                    
                </h1>
            </div>

            
            <div class="col-4 text-right">
                
                    
<div class="version-selector">
    <div class="btn-group">
        <button type="button" class="btn dropdown-toggle" data-toggle="dropdown" data-display="static" aria-haspopup="true" aria-expanded="false" id="version-selector-dropdown">
            
                v2
            
        </button>
        <div class="dropdown-menu dropdown-menu-right dropdown-menu-lg-left" aria-labelledby="version-selector-dropdown">
            
                
                    <a href="../../v3/intro/" class="dropdown-item">
                        
                            v3 (latest)
                        
                    </a>
                
            
                
                    <a href="../quick-start/" class="dropdown-item active">
                        
                            v2
                        
                    </a>
                
            
        </div>
    </div>
</div>


                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/laminas/laminas-di" class="header__link header__link--github" title="Go to repository of laminas-di">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12 content" role="main">
                
                
                    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">On this page</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#definitionlist" class="toc__link nav-link">DefinitionList</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#runtimedefinition" class="toc__link nav-link">RuntimeDefinition</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#compilerdefinition" class="toc__link nav-link">CompilerDefinition</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#classdefinition" class="toc__link nav-link">ClassDefinition</a>
                    </li>
                
            </ul>
        </div>
    

                

                
                    <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/">Overview</a></li>
            <li class="breadcrumb-item"><a href="https://docs.laminas.dev/components/">Components</a></li>

            
                <li class="breadcrumb-item"><a href="../..">laminas-di</a></li>

                
                    
                        
                        
                    
                
                    
                        
                        
                            <li class="breadcrumb-item">Reference</li>
                        
                    
                

                <li class="breadcrumb-item active" aria-current="page">Dependency Definitions</li>
            
        
    </ol>
</nav>



    <div class="alert alert-danger" role="alert">
        <h4>Caution</h4>
        <p>
            The documentation you are viewing is for an older version of this component.<br>
            <a href="../..">Switch to the latest (v3) version.</a>
        </p>
    </div>




    
    
        <h2 class="chapter__headline">Reference</h2>
    

    <h1 id="dependency-definitions">Dependency Definitions</h1>
<p>Definitions are what laminas-di uses to understand the structure of the code it is
attempting to wire. This means that if you've written non-ambiguous, clear, and
concise code, laminas-di has a very good chance of understanding how to wire things
up without much added complexity.</p>
<h2 id="definitionlist">DefinitionList</h2>
<p>Definitions are introduced to the <code>Laminas\Di\Di</code> object through a definition list
implemented as <code>Laminas\Di\DefinitionList</code> (which extends <code>SplDoublyLinkedList</code>).
Order is important. Definitions in the front of the list will be consulted on a
class before definitions at the end of the list.</p>
<blockquote>
<h3 id="autoloading">Autoloading</h3>
<p>Regardless of what kind of <code>DefinitionList</code> strategy you decide to use, it is
important that your autoloaders are already setup and ready to use.</p>
</blockquote>
<h2 id="runtimedefinition">RuntimeDefinition</h2>
<p>The default <code>DefinitionList</code> instantiated by <code>Laminas\Di\Di</code> when no other
DefinitionList is provided is <code>Laminas\Di\Definition\RuntimeDefinition</code>. The
<code>RuntimeDefinition</code> will respond to queries about classes by using PHP's
Reflection API. The <code>RuntimeDefinition</code> uses any available information inside
methods &mdash; including their signature, the names of parameters, the
type-hints of the parameters, and the default values &mdash; to determine if
something is optional or required when making a call to that method. The more
explicit you can be in your method naming and method signatures, the more likely
<code>Laminas\Di\Definition\RuntimeDefinition</code> will accurately understand the structure
of your code.</p>
<p>The constructor of <code>RuntimeDefinition</code> looks like the following:</p>
<pre class="highlight"><code class="language-php">public function __construct(
    IntrospectionStrategy $introspectionStrategy = null,
    array $explicitClasses = null
) {
    $this-&gt;introspectionStrategy = $introspectionStrategy ?: new IntrospectionStrategy();
    if ($explicitClasses) {
        $this-&gt;setExplicitClasses($explicitClasses);
    }
}</code></pre>
<p>The <code>IntrospectionStrategy</code> object is an object that defines the rules by which
the <code>RuntimeDefinition</code> will introspect information about your classes. Here are
the things it knows how to do:</p>
<ul>
<li>
<p>Whether or not to use annotations (scanning and parsing annotations is
  expensive, and thus disabled by default).</p>
</li>
<li>
<p>Which method names to include in the introspection; this is a list of
  patterns. By default, it registers the pattern <code>/^set\[A-Z\]{1}\\w\*/</code>.</p>
</li>
<li>
<p>Which interface names represent the interface injection pattern; this is a
  list of patterns. By default, the pattern <code>/\\w\*Aware\\w\*/</code> is registered.</p>
</li>
</ul>
<p>The constructor for the <code>IntrospectionStrategy</code> looks like this:</p>
<pre class="highlight"><code class="language-php">public function __construct(AnnotationManager $annotationManager = null)
{
    $this-&gt;annotationManager = $annotationManager ?: $this-&gt;createDefaultAnnotationManager();
}</code></pre>
<p>The <code>AnnotationManager</code> is not required. If you wish to create a special
<code>AnnotationManager</code> with your own annotations, and also wish to extend the
<code>RuntimeDefinition</code> to look for those annotations, this is the place to do it.</p>
<p>The <code>RuntimeDefinition</code> also can be used to look up either all classes
(implicitly, which is default), or explicitly look up for particular pre-defined
classes. This is useful when your strategy for inspecting one set of classes
might differ from those of another strategy for another set of classes. This can
be achieved by using the <code>setExplicitClasses()</code> method or by passing a list of
classes as the second constructor argument of the <code>RuntimeDefinition</code>.</p>
<h2 id="compilerdefinition">CompilerDefinition</h2>
<p>The <code>CompilerDefinition</code> is similar in nature to the <code>RuntimeDefinition</code> with
the exception that it can be seeded with more information for the purposes of
"compiling" a definition. Compiled definitions eliminate reflection calls and
annotation scannning, which can be a performance bottleneck in your production
applications.</p>
<p>For example, let's assume we want to create a script that will create
definitions for some of our library code:</p>
<pre class="highlight"><code class="language-php">// in "package name" format
$components = [
    'My_MovieApp',
    'My_OtherClasses',
];

foreach ($components as $component) {
    $diCompiler = new Laminas\Di\Definition\CompilerDefinition;
    $diCompiler-&gt;addDirectory('/path/to/classes/' . str_replace('_', '/', $component));

    $diCompiler-&gt;compile();
    file_put_contents(
        __DIR__ . '/../data/di/' . $component . '-definition.php',
        '&lt;?php return ' . var_export($diCompiler-&gt;toArrayDefinition()-&gt;toArray(), true) . ';'
    );
}</code></pre>
<p>The above creates a file for each "package", containing the full definition for
the classes defined for each. To utilize this in an application, use the
following:</p>
<pre class="highlight"><code class="language-php">protected function setupDi(Application $app)
{
    $definitionList = new DefinitionList([
        new Definition\ArrayDefinition(include __DIR__ .  '/path/to/data/di/My_MovieApp-definition.php'),
        new Definition\ArrayDefinition(include __DIR__ .  '/path/to/data/di/My_OtherClasses-definition.php'),
        $runtime = new Definition\RuntimeDefinition(),
    ]);
    $di = new Di($definitionList, null, new Config($this-&gt;config-&gt;di));
    $di-&gt;instanceManager()-&gt;addTypePreference('Laminas\Di\LocatorInterface', $di);
    $app-&gt;setLocator($di);
}</code></pre>
<p>The above code would more than likely go inside your application's bootstrap or
within a <code>Module</code> class. This represents the simplest and most performant way
of configuring your DiC for usage.</p>
<h2 id="classdefinition">ClassDefinition</h2>
<p>The idea behind using a <code>ClassDefinition</code> is two-fold. First, you may want to
override some information inside of a <code>RuntimeDefinition</code>. Secondly, you might
want to simply define your complete class's definition with an xml, ini, or php
file describing the structure. This class definition can be fed in via
<code>Configuration</code> or by directly instantiating and registering the <code>Definition</code>
with the <code>DefinitionList</code>.</p>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../quick-start/">
                    <small class="page-nav__label">Previous</small>
                    <i class="fa fa-chevron-left"></i>
                    Quick Start
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../instance-manager/">
                    <small class="page-nav__label">Next</small>
                    Instance Manager
                    <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



                
            </div>
            <div class="col-md-3 col-sm-12 sidebar">
                <div class="donation-banner">
    <a href="https://getlaminas.org/support/">
        <h2>Donate</h2>
        <p>Support Laminas Developers Directly</p>
        <img src="https://funding.communitybridge.org/assets/cb-f-horizontal-white.svg">
    </a>
</div>

                
                    <div class="component-selector">
    
    <h5 class="component-selector__subtitle">Find documentationâ€¦</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">laminas-di</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                
            

                
                
                    
                        
    <li class="subnavigation__list-item ">
        <a href="../quick-start/" class="subnavigation__link">Quick Start</a>
    </li>

                    
                        
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">Reference</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Dependency Definitions</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../instance-manager/" class="subnavigation__link">Instance Manager</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../config/" class="subnavigation__link">Configuration</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../debugging-and-complex-use-cases/" class="subnavigation__link">Debugging And Complex Use Cases</a>
    </li>

            
        </ul>
    </li>

                    
                
            
        </ul>
    </div>

                    
                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <h5>Laminas</h5>
                <ul>
                    <li>Laminas Project <a href="https://getlaminas.org/">The new foundation for the community-supported, open source continuation of Zend Framework</a></li>
                    <li>Laminas Components and MVC <a href="https://docs.laminas.dev/">Components and MVC for enterprise applications</a></li>
                    <li>Mezzio <a href="https://docs.mezzio.dev/">PSR-15 middleware in minutes</a></li>
                    <li>Laminas API Tools <a href="https://api-tools.getlaminas.org/">Build RESTful APIs in minutes</a></li>
                </ul>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="row">

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Support</h4>
                        <ul class="support__list">
                            <li class="support__list-item">
                                <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://laminas.dev/chat" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://github.com/laminas" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://twitter.com/getlaminas" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/blog/rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                            </li>
                            <li class="support__list-item">
                                <a href="https://getlaminas.org/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                            </li>
                        </ul>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">License</h4>
                        <p>
                            Code licensed under <a
                                href="https://github.com/laminas/laminas-di/blob/-/LICENSE.md">BSD 3-Clause</a>.
                        </p>
                    </div>

                    
                    <div class="col-md-4">
                        <h4 class="footer__headline">Copyright</h4>
                        <p>
                            <!--Built with love by the Laminas team with the help of our
                            <a href="https://github.com/laminas/laminas-di/graphs/contributors">contributors</a>.<br>-->
                            &copy; 2023 <a href="https://getlaminas.org/">Laminas Project</a> a Series of LF Projects, LLC.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

    <script>
        let base_url = '../..',
            project  = "components",
            siteName = 'laminas-di';
    </script>
    <script src="https://docs.laminas.dev/js/scripts.js"></script>
    
        <script src="../../search/main.js"></script>
    

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Search</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
            </div>
            <div class="modal-body">
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search in laminas-di" id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
        </div>
    </div>
</div>
</body>


</html>
